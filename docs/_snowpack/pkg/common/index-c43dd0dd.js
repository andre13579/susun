import{u as f,v as q,w,s as x,x as z}from"./index-81606468.js";const o=[];function _(e,i){return{subscribe:h(e,i).subscribe}}function h(e,i=f){let u;const t=new Set;function b(n){if(x(e,n)&&(e=n,u)){const r=!o.length;for(const s of t)s[1](),o.push(s,e);if(r){for(let s=0;s<o.length;s+=2)o[s][0](o[s+1]);o.length=0}}}function l(n){b(n(e))}function a(n,r=f){const s=[n,r];return t.add(s),t.size===1&&(u=i(b)||f),n(e),()=>{t.delete(s),t.size===0&&(u(),u=null)}}return{set:b,update:l,subscribe:a}}function A(e,i,u){const t=!Array.isArray(e),b=t?[e]:e,l=i.length<2;return _(u,a=>{let n=!1;const r=[];let s=0,d=f;const g=()=>{if(s)return;d();const c=i(t?r[0]:r,a);l?a(c):d=z(c)?c:f},y=b.map((c,p)=>q(c,m=>{r[p]=m,s&=~(1<<p),n&&g()},()=>{s|=1<<p}));return n=!0,g(),function(){w(y),d()}})}export{A as d,_ as r,h as w};
